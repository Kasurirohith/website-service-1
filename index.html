<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Services App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8fafc;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 24px;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .brand-name {
            font-size: 22px;
            font-weight: 700;
            color: #333;
        }

        .search-input-group {
            display: flex;
            align-items: center;
            flex-grow: 1;
            margin: 0 20px; /* Adjusted margin for better spacing */
            border: 1px solid #ccc;
            border-radius: 24px;
            max-width: 600px; /* Max width for search bar */
            overflow: hidden;
        }

        .search-box {
            flex-grow: 1;
            padding: 10px 16px;
            border: none;
            outline: none;
        }

        .search-icon-btn {
            background-color: transparent;
            border: none;
            padding: 10px 16px;
            cursor: pointer;
            font-size: 1.25rem;
            color: black !important;
            transition: color 0.3s ease;
        }

        .search-icon-btn:hover {
            color: #A259FF !important;
        }

        .nav-icons {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon-btn {
            background-color: transparent;
            border: none;
            padding: 0;
            cursor: pointer;
            font-size: 1.5rem;
            color: black !important;
            transition: color 0.3s ease;
        }

        .icon-btn:hover {
            color: #A259FF !important;
        }

        /* Cart counter */
        #cartItemCount {
            background-color: #ef4444; /* Red */
            color: white;
            font-size: 0.75rem; /* text-xs */
            font-weight: bold;
            border-radius: 9999px; /* rounded-full */
            width: 20px; /* h-5 */
            height: 20px; /* w-5 */
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -8px; /* -top-2 */
            right: -8px; /* -right-2 */
        }


        .app-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
            background-color: white;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid #e2e8f0;
            /* Hide on screens larger than mobile */
            @media (min-width: 768px) {
                display: none;
            }
        }

        .app-content {
            padding-top: 7rem; /* Space for fixed navbar */
            padding-bottom: 5rem; /* Space for fixed footer */
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            min-height: calc(100vh - 12rem); /* Ensure content fills space */
        }

        /* Custom Scrollbar for Webkit browsers */
        .app-content::-webkit-scrollbar {
            width: 8px;
        }

        .app-content::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 10px;
        }

        .app-content::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 10px;
        }

        .app-content::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        .hero-bg-app {
            background-image: url('https://tse1.mm.bing.net/th?id=OIP.hMe6teN6G2mBQw2zbN3YKwHaEK&pid=Api&P=0&h=180');
            background-size: cover;
            background-position: center;
            position: relative;
            z-index: 1;
            color: white;
            padding: 6rem 1rem; /* Adjust padding for responsiveness */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* shadow-xl */
        }

        .hero-bg-app::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.65);
            z-index: -1;
            border-radius: inherit;
        }

        /* Modal styles */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
            opacity: 0;
            transform: scale(0.95);
            visibility: hidden;
        }
        .modal-overlay.show {
            opacity: 1;
            transform: scale(1);
            visibility: visible;
        }
        .modal-content {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            transform: translateY(20px);
            opacity: 0;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        /* Map container for Google Map */
        #map {
            width: 100%;
            height: 200px;
            background-color: #e0e0e0;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex; /* For centering placeholder text */
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        /* Service card highlighting for search */
        .service-card.highlight {
            border: 2px solid #A259FF; /* Purple border */
            box-shadow: 0 0 15px rgba(162, 89, 255, 0.4); /* Purple glow */
            animation: pulseHighlight 1s ease-in-out 3; /* Pulse 3 times */
        }

        @keyframes pulseHighlight {
            0% { transform: scale(1); box-shadow: 0 0 15px rgba(162, 89, 255, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 25px rgba(162, 89, 255, 0.7); }
            100% { transform: scale(1); box-shadow: 0 0 15px rgba(162, 89, 255, 0.4); }
        }

        /* Payment method selection */
        .payment-method-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            position: relative;
        }
        .payment-method-option:hover {
            background-color: #f0f4f8;
            border-color: #cbd5e1;
        }
        .payment-method-option.selected {
            border-color: #A259FF;
            box-shadow: 0 0 0 2px rgba(162, 89, 255, 0.3);
            background-color: #f3e8ff; /* purple-50 */
        }
        .payment-method-option input[type="radio"] {
            margin-right: 12px;
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 50%;
            outline: none;
            transition: all 0.2s ease-in-out;
            position: relative;
            flex-shrink: 0;
        }
        .payment-method-option input[type="radio"]:checked {
            border-color: #A259FF;
            background-color: #A259FF;
        }
        .payment-method-option input[type="radio"]:checked::after {
            content: '';
            width: 8px;
            height: 8px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .payment-details-form {
            margin-top: 15px;
            border-top: 1px solid #e2e8f0;
            padding-top: 15px;
        }

        /* Login Success Message */
        #loginSuccessMessage {
            position: fixed;
            top: 120px; /* Below navbar */
            left: 50%;
            transform: translateX(-50%);
            background-color: #22c55e; /* green-500 */
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
            z-index: 1001;
            text-align: center;
            font-size: 1.25rem;
            font-weight: 600;
        }
        #loginSuccessMessage.show {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="min-h-screen">

    <div class="navbar">
        <div class="logo-section">
            <a href="#" class="flex items-center text-2xl font-extrabold text-[#333]">
                <img src="https://tse3.mm.bing.net/th?id=OIP.vNEEUyQUO37tN3XUrRaNPgHaFj&pid=Api&P=0&h=180" alt="HomeServices Logo" class="w-10 h-auto mr-2 rounded-full">
                <span class="font-bold">Home</span> <span class="font-semibold" style="color:#A259FF;">Services</span>
            </a>
        </div>

        <div class="search-input-group">
            <input type="text" id="serviceSearchInput" class="search-box" placeholder="Search for services (e.g., AC, TV)...">
            <button id="searchButton" class="search-icon-btn">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <div class="nav-icons">
            <button class="icon-btn relative" onclick="openModal('cartModal')">
                <i class="fas fa-shopping-cart"></i>
                <span id="cartItemCount" class="hidden">0</span>
            </button>
            <button class="icon-btn" onclick="openModal('loginModal')">
                <i class="fas fa-user-circle"></i>
            </button>
        </div>
    </div>

    <div id="loginSuccessMessage" class="hidden">
        Login Successful!
    </div>

    <main class="app-content container mx-auto px-4 py-6">
        <section class="hero-bg-app text-white mb-8">
            <div class="max-w-xl mx-auto">
                <h1 class="text-4xl md:text-5xl font-extrabold mb-4 leading-tight drop-shadow-lg">
                    Quick Fixes for Your <span class="text-yellow-300">Home</span>
                </h1>
                <p class="text-lg md:text-xl mb-8 opacity-95 leading-relaxed">
                    Expert repairs, affordable prices, right at your doorstep.
                </p>
                <button id="bookServiceAppHeroBtn" class="bg-white text-purple-700 px-8 py-4 text-lg font-bold rounded-full hover:bg-gray-100 transition-all duration-300 shadow-lg transform hover:scale-105">
                    Book a Service
                </button>
            </div>
        </section>

        <section class="py-6 px-2 bg-white rounded-xl shadow-md mb-8 border border-gray-200">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Popular Categories</h2>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-ac-repair')">
                    <i class="fas fa-snowflake text-3xl text-purple-500 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">AC Repair</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-tv-repair')">
                    <i class="fas fa-tv text-3xl text-red-500 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">TV Repair</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-fan-repair')">
                    <i class="fas fa-fan text-3xl text-green-500 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">Fan Repair</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-electrical-wiring')">
                    <i class="fas fa-lightbulb text-3xl text-yellow-500 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">Electricals</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-plumbing')">
                    <i class="fas fa-faucet text-3xl text-purple-400 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">Plumbing</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-appliance-repair')">
                    <i class="fas fa-blender text-3xl text-purple-500 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">Appliances</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-carpentry')">
                    <i class="fas fa-hammer text-3xl text-orange-500 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">Carpentry</span>
                </div>
                <div class="flex flex-col items-center p-3 rounded-lg hover:bg-purple-50 transition-colors duration-200 cursor-pointer" onclick="scrollToService('service-pest-control')">
                    <i class="fas fa-bug text-3xl text-gray-600 mb-2"></i>
                    <span class="text-sm font-medium text-gray-700">Pest Control</span>
                </div>
            </div>
        </section>

        <section id="services-listing" class="py-6 px-2 bg-white rounded-xl shadow-md mb-8 border border-gray-200">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Recommended Services</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

                <div id="service-ac-repair" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="AC Repair"
                    onclick="showServiceDetail('AC Repair & Service', 'Cooling issues? Our technicians handle all types of AC repairs for a comfortable home. Includes gas check, filter cleaning, and basic troubleshooting.', 499, 'https://chillsairconditioning.com/wp-content/uploads/2021/05/The-Demand-for-AC-Repair-in-Miami-FL-Is-Huge.jpg')">
                    <img src="https://chillsairconditioning.com/wp-content/uploads/2021/05/The-Demand-for-AC-Repair-in-Miami-FL-Is-Huge.jpg" alt="AC Repair" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">AC Repair & Service</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Cooling issues? Our technicians handle all types of AC repairs.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹499</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-tv-repair" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="TV Repair"
                    onclick="showServiceDetail('TV & Entertainment System Repair', 'From smart TVs to home theaters, we fix all entertainment device malfunctions including display issues, sound problems, and connectivity.', 349, 'https://tse1.mm.bing.net/th?id=OIP.CXxF4w_AtcDwBSq0HEkp1wHaE8&pid=Api&P=0&h=180')">
                    <img src="https://tse1.mm.bing.net/th?id=OIP.CXxF4w_AtcDwBSq0HEkp1wHaE8&pid=Api&P=0&h=180" alt="TV Repair" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">TV & Entertainment Repair</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        We fix all entertainment device malfunctions.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹349</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-fan-repair" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="Fan Repair"
                    onclick="showServiceDetail('Fan Repair & Installation', 'Ceiling fans, table fans, exhaust fans – get them spinning efficiently again. Includes motor repair, blade alignment, and wiring checks.', 199, 'https://tse4.mm.bing.net/th?id=OIP.EHL3-9-c2y6k9ZaPn_PdbQHaFp&pid=Api&P=0&h=180')">
                    <img src="https://tse4.mm.bing.net/th?id=OIP.EHL3-9-c2y6k9ZaPn_PdbQHaFp&pid=Api&P=0&h=180" alt="Fan Repair" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">Fan Repair & Installation</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Get your ceiling, table, or exhaust fans spinning efficiently.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹199</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-electrical-wiring" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="Electrical Repair, Electrician"
                    onclick="showServiceDetail('Electrical Wiring & Fixtures', 'From faulty switches to complete rewiring, our electricians ensure safety. Includes fuse box repair, socket installation, and light fixture fixes.', 299, 'https://tse3.mm.bing.net/th?id=OIP.eiGUx2YP1MxeDoh52BUefQHaC9&pid=Api&P=0&h=180')">
                    <img src="https://tse3.mm.bing.net/th?id=OIP.eiGUx2YP1MxeDoh52BUefQHaC9&pid=Api&P=0&h=180" alt="Electrical Repair" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">Electrical Wiring & Fixtures</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Faulty switches to complete rewiring, our electricians ensure safety.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹299</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-plumbing" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="Plumbing, Leak Fixes"
                    onclick="showServiceDetail('Plumbing & Leak Fixes', 'Leaky taps, clogged drains, and pipe repairs – reliable plumbing solutions. Includes faucet repair, pipe fitting, and drain cleaning.', 249, 'https://tse2.mm.bing.net/th?id=OIP.jUGKWpAud_fQC6mQKNns5wHaE8&pid=Api&P=0&h=180')">
                    <img src="https://tse2.mm.bing.net/th?id=OIP.jUGKWpAud_fQC6mQKNns5wHaE8&pid=Api&P=0&h=180" alt="Plumbing Repair" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">Plumbing & Leak Fixes</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Leaky taps, clogged drains, and pipe repairs – reliable solutions.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹249</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-appliance-repair" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="Appliance Repair, Refrigerator, Washing Machine"
                    onclick="showServiceDetail('General Appliance Repair', 'From refrigerators to washing machines, we fix a wide range of home appliances including microwaves, water purifiers, and geysers.', 399, 'https://tse3.mm.bing.net/th?id=OIP.LuRey1GOr_eXXvcOam_ihAHaC1&pid=Api&P=0&h=180')">
                    <img src="https://tse1.mm.bing.net/th?id=OIP.eE1iC1AYvwwcIK0Z-7ALAgHaC4&pid=Api&P=0&h=180" alt="General Appliance Repair" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">General Appliance Repair</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Refrigerators to washing machines, we fix a wide range of appliances.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹399</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-carpentry" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="Carpentry, Woodwork"
                    onclick="showServiceDetail('Carpentry Services', 'Skilled carpenters for all your home furniture repair and installation needs. From fixing broken chairs to custom shelving.', 450, 'https://tse1.mm.bing.net/th?id=OIP.rD8NmyBSNCpiN3vm_iVkIQHaE8&pid=Api&P=0&h=180')">
                    <img src="https://tse1.mm.bing.net/th?id=OIP.rD8NmyBSNCpiN3vm_iVkIQHaE8&pid=Api&P=0&h=180" alt="Carpentry" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">Carpentry Services</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Skilled carpenters for all your home furniture repair and installation needs.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹450</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

                <div id="service-pest-control" class="service-card flex flex-col items-center text-center p-4 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 group cursor-pointer"
                    data-service-name="Pest Control, Exterminator, Bug"
                    onclick="showServiceDetail('Pest Control Services', 'Effective solutions for common household pests like cockroaches, ants, and termites. Safe and efficient treatment methods.', 600, 'https://static.vecteezy.com/system/resources/previews/000/484/526/original/vector-pest-control-service-illustration.jpg')">
                    <img src="https://static.vecteezy.com/system/resources/previews/000/484/526/original/vector-pest-control-service-illustration.jpg" alt="Pest Control" class="w-full h-32 object-cover rounded-md mb-4 shadow-md group-hover:scale-102 transition-transform duration-300">
                    <h3 class="text-lg font-bold text-gray-900 mb-1">Pest Control Services</h3>
                    <p class="text-gray-600 text-sm leading-relaxed mb-2">
                        Effective solutions for common household pests like cockroaches, ants, and termites.
                    </p>
                    <p class="text-xl font-bold text-purple-600 mb-3">₹600</p>
                    <button class="book-service-btn bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-semibold hover:bg-purple-600 transition-all duration-300">View Details</button>
                </div>

            </div>
        </section>

        <section id="about" class="py-8 px-4 bg-white rounded-xl shadow-md mb-8 border border-gray-200">
            <div class="flex flex-col-reverse md:flex-row items-center justify-between gap-6">
                <div class="md:w-1/2 flex justify-center">
                    <img src="https://tse4.mm.bing.net/th?id=OIP._ETmUdvwva9rueC6JwNq1AHaDZ&pid=Api&P=0&h=180" alt="About Us Team" class="rounded-lg shadow-md max-w-full h-auto object-cover">
                </div>
                <div class="md:w-1/2 text-center md:text-left">
                    <h2 class="text-2xl font-bold text-gray-800 mb-3 leading-tight">
                        About <span class="text-purple-600">HomeServices</span>
                    </h2>
                    <p class="text-base text-gray-700 mb-4 leading-relaxed">
                        At HomeServices, we believe in extending the life of your valuable home appliances and systems.
                        Our mission is to provide expert, affordable, and reliable second-hand repair services right at your doorstep.
                    </p>
                    <p class="text-sm text-gray-600 leading-relaxed">
                        We are committed to customer satisfaction, transparent pricing, and environmentally friendly repair practices.
                    </p>
                </div>
            </div>
        </section>

        <section id="testimonials" class="py-8 px-4 bg-white rounded-xl shadow-md mb-8 border border-gray-200">
            <h2 class="text-2xl font-bold text-gray-800 text-center mb-8 leading-tight">
                What Our Customers <span class="text-purple-600">Say</span>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl">
                    <img src="https://tse3.mm.bing.net/th?id=OIP.48C1fjm5A4taM6KNeVPyTQHaKI&pid=Api&P=0&h=180" alt="Customer Priya Sharma" class="w-20 h-20 rounded-full object-cover mb-4 border-2 border-purple-400 shadow-md">
                    <p class="text-base text-gray-700 italic mb-3">
                        "HomeServices saved my old AC! The technician was professional, knowledgeable, and the repair was done quickly and at a great price. Highly recommend!"
                    </p>
                    <p class="font-bold text-purple-600">- Priya Sharma</p>
                    <p class="text-gray-500 text-xs">Hyderabad</p>
                </div>
                <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl">
                    <img src="https://tse3.mm.bing.net/th?id=OIP.eJ4BA7hzUGjKZ0qUEfAgVQHaHa&pid=Api&P=0&h=180" alt="Customer Rahul Singh" class="w-20 h-20 rounded-full object-cover mb-4 border-2 border-purple-400 shadow-md">
                    <p class="text-base text-gray-700 italic mb-3">
                        "My TV stopped working, and I thought I'd have to buy a new one. HomeServices repaired it perfectly, and it's as good as new! Excellent service."
                    </p>
                    <p class="font-bold text-purple-600">- Rahul Singh</p>
                    <p class="text-gray-500 text-xs">Bengaluru</p>
                </div>
                <div class="flex flex-col items-center text-center p-6 bg-gray-50 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl">
                    <img src="https://tse1.mm.bing.net/th?id=OIP.0_INywwz74o8LLO4Lz7vCAHaEo&pid=Api&P=0&h=180" alt="Customer Sneha Reddy" class="w-20 h-20 rounded-full object-cover mb-4 border-2 border-purple-400 shadow-md">
                    <p class="text-base text-gray-700 italic mb-3">
                        "Prompt response and effective plumbing repair. The technician was friendly and very efficient. HomeServices is my go-to for all home repairs now."
                    </p>
                    <p class="font-bold text-purple-600">- Sneha Reddy</p>
                    <p class="text-gray-500 text-xs">Chennai</p>
                </div>
            </div>
        </section>

        <section class="bg-purple-700 text-white py-12 px-4 text-center rounded-xl shadow-xl flex flex-col items-center justify-center">
            <h2 class="text-3xl font-bold mb-4 leading-tight">
                Ready to Book a Repair?
            </h2>
            <p class="text-lg opacity-95 mb-8 leading-relaxed">
                Don't let faulty appliances stress you out. Get your home back in order.
            </p>
            <button id="bookServiceFinalCtaBtn" class="bg-white text-purple-700 px-8 py-4 text-lg font-bold rounded-full hover:bg-gray-100 transition-all duration-300 shadow-lg transform hover:scale-105">
                Book a Service
            </button>
        </section>
    </main>

    <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay">
        <div class="bg-white p-6 rounded-lg shadow-lg modal-content w-11/12 max-w-sm">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Login</h2>
            <input type="text" placeholder="Username" class="w-full border border-gray-300 rounded p-2 mb-2 focus:ring-purple-500 focus:border-purple-500 outline-none">
            <input type="password" placeholder="Password" class="w-full border border-gray-300 rounded p-2 mb-4 focus:ring-purple-500 focus:border-purple-500 outline-none">
            <div class="flex justify-end gap-2">
                <button onclick="closeModal('loginModal')" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition-colors">Close</button>
                <button onclick="simulateLogin()" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition-colors">Login</button>
            </div>
        </div>
    </div>

    <div id="cartModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay">
        <div class="bg-white p-6 rounded-lg shadow-lg modal-content w-11/12 max-w-md">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Your Cart</h2>
            <div id="cartItemsContainer" class="max-h-60 overflow-y-auto pr-2 mb-4 border border-gray-200 rounded-md p-2">
                <p id="emptyCartMessage" class="text-gray-600 text-center py-4">No items added yet. Add services by clicking "View Details"!</p>
                </div>
            <div class="text-right text-lg font-bold text-gray-800 mb-4">Total: ₹<span id="cartTotal">0</span></div>
            <div class="flex justify-end gap-2">
                <button onclick="closeModal('cartModal')" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition-colors" >Close</button>
                <button onclick="openPaymentModal()" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition-colors" id="proceedToCheckoutBtn">Proceed to Checkout</button>
            </div>
        </div>
    </div>

    <div id="serviceDetailModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay">
        <div class="bg-white p-6 rounded-lg shadow-lg max-w-lg w-11/12 modal-content">
            <img id="serviceDetailImage" src="" alt="Service Image" class="w-full h-48 object-cover rounded-md mb-4 border border-gray-200">
            <h2 id="serviceDetailTitle" class="text-2xl font-bold text-gray-800 mb-2"></h2>
            <p id="serviceDetailDescription" class="text-gray-700 mb-4 text-sm"></p>
            <p class="text-xl font-bold text-purple-600 mb-4">Price: ₹<span id="serviceDetailPrice"></span></p>
            <div class="flex justify-end gap-3">
                <button onclick="closeModal('serviceDetailModal')" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition-colors duration-200">Close</button>
                <button id="addToCartButton" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition-colors duration-200">Add to Cart</button>
            </div>
        </div>
    </div>

    <div id="paymentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay">
        <div class="bg-white p-6 rounded-lg shadow-lg modal-content w-11/12 max-w-md">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800 text-center">Select Payment Method</h2>
            
            <div class="mb-4">
                <label for="totalAmount" class="block text-lg font-medium text-gray-700 mb-2">Total Amount:</label>
                <p class="text-3xl font-bold text-purple-700">₹<span id="paymentTotalAmount">0</span></p>
            </div>

            <div class="space-y-3 mb-6">
                <label class="payment-method-option" onclick="selectPaymentMethod('card')">
                    <input type="radio" name="paymentMethod" value="card" id="radioCard">
                    <div class="flex items-center flex-grow">
                        <i class="fas fa-credit-card text-2xl text-blue-500 mr-3"></i>
                        <span class="font-medium text-gray-800">Credit / Debit Card</span>
                    </div>
                </label>
                <div id="cardDetails" class="payment-details-form hidden">
                    <input type="text" placeholder="Card Number" class="w-full border border-gray-300 rounded p-2 mb-2 focus:ring-purple-500 focus:border-purple-500 outline-none">
                    <div class="flex gap-2 mb-2">
                        <input type="text" placeholder="MM/YY" class="w-1/2 border border-gray-300 rounded p-2 focus:ring-purple-500 focus:border-purple-500 outline-none">
                        <input type="text" placeholder="CVV" class="w-1/2 border border-gray-300 rounded p-2 focus:ring-purple-500 focus:border-purple-500 outline-none">
                    </div>
                </div>

                <label class="payment-method-option" onclick="selectPaymentMethod('upi')">
                    <input type="radio" name="paymentMethod" value="upi" id="radioUPI">
                    <div class="flex items-center flex-grow">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/e/e1/UPI-Logo-Vector.svg" alt="UPI" class="w-6 h-6 mr-3">
                        <span class="font-medium text-gray-800">UPI (PhonePe, Google Pay, Paytm)</span>
                    </div>
                </label>
                <div id="upiDetails" class="payment-details-form hidden">
                    <input type="text" placeholder="Enter UPI ID (e.g., yourname@bank)" class="w-full border border-gray-300 rounded p-2 mb-2 focus:ring-purple-500 focus:border-purple-500 outline-none">
                    <p class="text-sm text-gray-500">You will be redirected to your UPI app for payment.</p>
                </div>

                <label class="payment-method-option" onclick="selectPaymentMethod('cod')">
                    <input type="radio" name="paymentMethod" value="cod" id="radioCOD">
                    <div class="flex items-center flex-grow">
                        <i class="fas fa-money-bill-wave text-2xl text-green-600 mr-3"></i>
                        <span class="font-medium text-gray-800">Cash on Delivery (COD)</span>
                    </div>
                </label>
            </div>

            <div class="flex justify-end gap-2">
                <button onclick="closeModal('paymentModal')" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-400 transition-colors">Cancel</button>
                <button onclick="processPayment()" class="bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition-colors">Confirm Payment</button>
            </div>
        </div>
    </div>

    <div id="trackingModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay">
        <div class="bg-white p-6 rounded-lg shadow-lg max-w-xl w-11/12 modal-content">
            <h2 class="text-2xl font-semibold mb-4 text-center text-gray-800">Track Your Service Man</h2>
            <div id="map">
                <p>Google Maps API not loaded. Showing a placeholder map.</p>
                <img src="https://maps.googleapis.com/maps/api/staticmap?center=17.3850,78.4867&zoom=12&size=400x200&markers=color:red%7Clabel:D%7C17.3850,78.4867&key=" alt="Static Map Placeholder" class="w-full h-auto rounded-md mt-2">
                <p class="text-xs mt-2">To enable, get a Google Maps API Key and uncomment the script tag in the \`head\` section.</p>
            </div>
            <div class="mb-4 text-center">
                <p class="text-lg font-semibold text-gray-800">Service Man: <span id="servicemanName">Ramesh Kumar</span></p>
                <p class="text-gray-600">Estimated Arrival: <span id="servicemanETA">Loading...</span></p>
                <p class="text-gray-600">Current Status: <span id="servicemanStatus" class="font-medium text-yellow-600">Step 1: Waiting for service man...</span></p>
                <p class="text-gray-700 mt-2">Current Location: <span id="servicemanAddress" class="font-semibold">Searching...</span></p>
                <p class="text-sm text-gray-500 mt-1">Contact: <a href="tel:+919876543210" class="text-purple-600 hover:underline">+91 98765 43210</a></p>
            </div>
            <div class="flex justify-end">
                <button onclick="closeModal('trackingModal')" class="bg-purple-600 text-white px-4 py-2 rounded">Close</button>
            </div>
        </div>
    </div>

    <div class="app-footer">
        <a href="#" class="flex flex-col items-center text-purple-600 nav-item active">
            <i class="fas fa-home text-xl"></i>
            <span class="text-xs mt-1">Home</span>
        </a>
        <a href="#services-listing" class="flex flex-col items-center text-gray-500 hover:text-purple-600 transition-colors nav-item">
            <i class="fas fa-wrench text-xl"></i>
            <span class="text-xs mt-1">Services</span>
        </a>
        <a href="#" onclick="openModal('trackingModal'); return false;" class="flex flex-col items-center text-gray-500 hover:text-purple-600 transition-colors nav-item">
            <i class="fas fa-truck-moving text-xl"></i>
            <span class="text-xs mt-1">Track</span>
        </a>
        <a href="#" onclick="openModal('loginModal'); return false;" class="flex flex-col items-center text-gray-500 hover:text-purple-600 transition-colors nav-item">
            <i class="fas fa-user-circle text-xl"></i>
            <span class="text-xs mt-1">Account</span>
        </a>
    </div>

    <script>
        let cartItems = []; // Stores objects: { title, price }
        let currentService = {}; // Stores details of the service currently in the detail modal
        let selectedPaymentMethod = ''; // Stores the currently selected payment method
        
        // Google Maps related variables
        let map;
        let servicemanMarker;
        let servicemanPath; // To draw the path
        let currentServicemanLocationIndex = 0;
        let movementInterval;

        // Simulate a path for the service man (Hyderabad coordinates - for demonstration purposes)
        const servicemanRoute = [
            { lat: 17.4475, lng: 78.3475, address: "Hitech City, Hyderabad" }, // Starting point (e.g., technician's base)
            { lat: 17.4385, lng: 78.3620, address: "Kondapur, Hyderabad" },
            { lat: 17.4280, lng: 78.3750, address: "Gachibowli, Hyderabad" },
            { lat: 17.4150, lng: 78.4000, address: "Madhapur, Hyderabad" },
            { lat: 17.4000, lng: 78.4200, address: "Jubilee Hills, Hyderabad" },
            { lat: 17.4050, lng: 78.4400, address: "Banjara Hills, Hyderabad" },
            { lat: 17.4080, lng: 78.4600, address: "Panjagutta, Hyderabad" },
            { lat: 17.4150, lng: 78.4750, address: "Begumpet, Hyderabad" },
            { lat: 17.4200, lng: 78.4867, address: "Secunderabad, Hyderabad" },
            { lat: 17.4050, lng: 78.4980, address: "Ameerpet, Hyderabad" },
            { lat: 17.3950, lng: 78.5050, address: "Somajiguda, Hyderabad" },
            { lat: 17.3850, lng: 78.4867, address: "Plot No. 12, Kavuri Hills, Hyderabad" } // Destination (customer's address)
        ];
        
        // --- MODAL FUNCTIONS ---
        function openModal(id) {
            const modal = document.getElementById(id);
            modal.classList.remove('hidden');
            void modal.offsetWidth; // Force reflow
            modal.classList.add('show');

            if (id === 'cartModal') {
                renderCartItems();
                // Disable checkout if cart is empty
                document.getElementById('proceedToCheckoutBtn').disabled = cartItems.length === 0;
                document.getElementById('proceedToCheckoutBtn').classList.toggle('opacity-50', cartItems.length === 0);
                document.getElementById('proceedToCheckoutBtn').classList.toggle('cursor-not-allowed', cartItems.length === 0);
            }
            if (id === 'trackingModal') {
                // Reset tracking state when modal is opened
                currentServicemanLocationIndex = 0; 
                if (movementInterval) {
                    clearInterval(movementInterval);
                    movementInterval = null;
                }
                initMap(); // Initialize/re-initialize map when tracking modal opens
            }
        }

        function closeModal(id) {
            const modal = document.getElementById(id);
            modal.classList.remove('show');
            modal.addEventListener('transitionend', function handler() {
                modal.classList.add('hidden');
                modal.removeEventListener('transitionend', handler);
                
                // Clear map interval when tracking modal closes
                if (id === 'trackingModal' && movementInterval) {
                    clearInterval(movementInterval);
                    movementInterval = null;
                    servicemanMarker = null; // Reset marker
                    servicemanPath = null; // Reset path
                    currentServicemanLocationIndex = 0; // Reset path index for next time
                    document.getElementById('servicemanStatus').className = 'font-medium text-yellow-600'; // Reset status color
                }
            });
        }

        // Close modals if clicking outside (on overlay)
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(event) {
                if (event.target === overlay) {
                    closeModal(overlay.id);
                }
            });
        });

        // --- LOGIN FUNCTIONALITY ---
        function simulateLogin() {
            // In a real app, you'd send credentials to a server here.
            // For this simulation, we just close the modal and show a success message.
            closeModal('loginModal');
            const successMessage = document.getElementById('loginSuccessMessage');
            successMessage.classList.remove('hidden');
            void successMessage.offsetWidth; // Trigger reflow for transition
            successMessage.classList.add('show');

            setTimeout(() => {
                successMessage.classList.remove('show');
                successMessage.addEventListener('transitionend', function handler() {
                    successMessage.classList.add('hidden');
                    successMessage.removeEventListener('transitionend', handler);
                }, { once: true });
            }, 3000); // Hide after 3 seconds
        }

        // --- CART FUNCTIONS ---
        function updateCartCount() {
            const cartItemCountSpan = document.getElementById('cartItemCount');
            if (cartItems.length > 0) {
                cartItemCountSpan.innerText = cartItems.length;
                cartItemCountSpan.classList.remove('hidden');
            } else {
                cartItemCountSpan.classList.add('hidden');
            }
        }

        function renderCartItems() {
            const cartItemsContainer = document.getElementById('cartItemsContainer');
            const emptyCartMessage = document.getElementById('emptyCartMessage');
            const cartTotalSpan = document.getElementById('cartTotal');
            cartItemsContainer.innerHTML = ''; // Clear previous items

            if (cartItems.length === 0) {
                emptyCartMessage.classList.remove('hidden');
            } else {
                emptyCartMessage.classList.add('hidden');
                let total = 0;
                cartItems.forEach((item, index) => {
                    total += item.price;
                    const itemDiv = document.createElement('div');
                    itemDiv.classList.add('flex', 'justify-between', 'items-center', 'py-2', 'border-b', 'border-gray-200');
                    itemDiv.innerHTML = `
                        <span class="font-medium text-gray-800">${item.title}</span>
                        <span class="text-purple-600">₹${item.price}</span>
                        <button class="text-red-500 hover:text-red-700 ml-2 text-lg" onclick="removeFromCart(${index})" title="Remove from cart">
                            <i class="fas fa-times-circle"></i>
                        </button>
                    `;
                    cartItemsContainer.appendChild(itemDiv);
                });
                cartTotalSpan.innerText = total;
            }
        }

        function addToCart() {
            if (currentService.title && currentService.price !== undefined) {
                cartItems.push({
                    title: currentService.title,
                    price: currentService.price
                });
                updateCartCount();
                renderCartItems(); // Re-render cart items in case cart modal is open
                closeModal('serviceDetailModal');
                alert(`${currentService.title} added to cart!`);
            }
        }

        function removeFromCart(index) {
            if (confirm(`Are you sure you want to remove "${cartItems[index].title}" from cart?`)) {
                cartItems.splice(index, 1);
                updateCartCount();
                renderCartItems();
                if (cartItems.length === 0) {
                    document.getElementById('proceedToCheckoutBtn').disabled = true;
                    document.getElementById('proceedToCheckoutBtn').classList.add('opacity-50', 'cursor-not-allowed');
                }
            }
        }

        // Function to show service details in the modal
        function showServiceDetail(title, description, price, imageUrl) {
            currentService = { title, description, price, imageUrl };
            document.getElementById('serviceDetailTitle').innerText = title;
            document.getElementById('serviceDetailDescription').innerText = description;
            document.getElementById('serviceDetailPrice').innerText = price;
            document.getElementById('serviceDetailImage').src = imageUrl;
            openModal('serviceDetailModal');
        }

        // Attach event listener to the "Add to Cart" button in the service detail modal
        document.getElementById('addToCartButton').addEventListener('click', addToCart);


        // --- SEARCH FUNCTIONALITY ---
        function scrollToService(serviceId) {
            const serviceElement = document.getElementById(serviceId);
            if (serviceElement) {
                document.querySelectorAll('.service-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                serviceElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });

                serviceElement.classList.add('highlight');
                setTimeout(() => {
                    serviceElement.classList.remove('highlight');
                }, 3000);
            }
        }

        function performSearch() {
            const searchTerm = document.getElementById('serviceSearchInput').value.toLowerCase().trim();
            const serviceCards = document.querySelectorAll('.service-card');
            let foundMatch = false;

            if (searchTerm === "") {
                alert("Please enter a service name to search.");
                return;
            }

            const keywords = searchTerm.split(' ').filter(word => word.length > 0);

            for (const card of serviceCards) {
                const serviceName = card.getAttribute('data-service-name').toLowerCase();
                const cardText = card.textContent.toLowerCase();

                const isMatch = keywords.some(keyword => serviceName.includes(keyword) || cardText.includes(keyword));

                if (isMatch) {
                    scrollToService(card.id);
                    foundMatch = true;
                    break;
                }
            }

            if (!foundMatch) {
                alert('No service found matching "' + searchTerm + '". Please try another search term.');
            }
        }

        // Event Listeners for Search
        document.getElementById('searchButton').addEventListener('click', performSearch);
        document.getElementById('serviceSearchInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                performSearch();
            }
        });

        // --- PAYMENT FUNCTIONS ---
        function openPaymentModal() {
            closeModal('cartModal'); // Close cart modal
            document.getElementById('paymentTotalAmount').innerText = document.getElementById('cartTotal').innerText;
            openModal('paymentModal');
            // Reset payment method selection on open
            document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
                radio.checked = false;
            });
            document.querySelectorAll('.payment-method-option').forEach(label => {
                label.classList.remove('selected');
            });
            document.getElementById('cardDetails').classList.add('hidden');
            document.getElementById('upiDetails').classList.add('hidden');
            selectedPaymentMethod = ''; // Clear selection
        }

        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            document.querySelectorAll('.payment-method-option').forEach(label => {
                label.classList.remove('selected');
            });
            document.getElementById(`radio${method.charAt(0).toUpperCase() + method.slice(1)}`).checked = true;
            document.getElementById(`radio${method.charAt(0).toUpperCase() + method.slice(1)}`).closest('label').classList.add('selected');

            // Show/hide specific payment details forms
            document.getElementById('cardDetails').classList.add('hidden');
            document.getElementById('upiDetails').classList.add('hidden');

            if (method === 'card') {
                document.getElementById('cardDetails').classList.remove('hidden');
            } else if (method === 'upi') {
                document.getElementById('upiDetails').classList.remove('hidden');
            }
        }

        function processPayment() {
            if (!selectedPaymentMethod) {
                alert("Please select a payment method.");
                return;
            }

            let paymentConfirmed = false;
            switch (selectedPaymentMethod) {
                case 'card':
                    const cardNumber = document.querySelector('#cardDetails input[placeholder="Card Number"]').value;
                    const expiry = document.querySelector('#cardDetails input[placeholder="MM/YY"]').value;
                    const cvv = document.querySelector('#cardDetails input[placeholder="CVV"]').value;
                    if (cardNumber && expiry && cvv) {
                        alert(`Processing Card Payment for ₹${document.getElementById('paymentTotalAmount').innerText}... (Simulated)`);
                        paymentConfirmed = true;
                    } else {
                        alert("Please fill in all card details.");
                    }
                    break;
                case 'upi':
                    const upiId = document.querySelector('#upiDetails input[placeholder="Enter UPI ID (e.g., yourname@bank)"]').value;
                    if (upiId) {
                        alert(`Initiating UPI Payment to ${upiId} for ₹${document.getElementById('paymentTotalAmount').innerText}... (Simulated)`);
                        paymentConfirmed = true;
                    } else {
                        alert("Please enter your UPI ID.");
                    }
                    break;
                case 'cod':
                    alert(`Cash on Delivery confirmed for ₹${document.getElementById('paymentTotalAmount').innerText}.`);
                    paymentConfirmed = true;
                    break;
                default:
                    alert("Invalid payment method selected.");
                    break;
            }

            if (paymentConfirmed) {
                cartItems = []; // Clear cart after successful payment
                updateCartCount(); // Update cart display
                closeModal('paymentModal');
                alert("Payment successful! Your service is booked. Now tracking your service man.");
                openModal('trackingModal'); // Open tracking modal automatically
            }
        }


        // --- GOOGLE MAPS & SERVICE TRACKING ---
        function initMap() {
            const mapDiv = document.getElementById('map');
            const servicemanStatusSpan = document.getElementById('servicemanStatus');
            const servicemanETASpan = document.getElementById('servicemanETA');
            const servicemanAddressSpan = document.getElementById('servicemanAddress');

            // Reset initial status for a new tracking session
            servicemanStatusSpan.innerHTML = "Step 1: Waiting for service man...";
            servicemanStatusSpan.className = 'font-medium text-yellow-600'; // Initial color for waiting
            servicemanETASpan.innerText = "Loading...";
            servicemanAddressSpan.innerText = "Searching...";

            // Check if Google Maps API is loaded
            if (typeof google === 'undefined' || typeof google.maps === 'undefined' || !google.maps.Map) {
                // If Google Maps API is not loaded, show a static image and message
                mapDiv.innerHTML = `<p>Google Maps API not loaded. Showing a placeholder map.</p>
                                    <img src="https://maps.googleapis.com/maps/api/staticmap?center=17.3850,78.4867&zoom=12&size=400x200&markers=color:red%7Clabel:D%7C17.3850,78.4867&key=" alt="Static Map Placeholder" class="w-full h-auto rounded-md mt-2">
                                    <p class="text-xs mt-2">To enable, get a Google Maps API Key and uncomment the script tag in the \`head\` section.</p>`;
                mapDiv.classList.remove('flex', 'items-center', 'justify-center', 'text-center');
                mapDiv.style.backgroundColor = 'transparent';
                console.warn("Google Maps API not loaded. Map functionality will be limited.");

                // Still simulate text updates even without the map
                currentServicemanLocationIndex = 0; // Ensure reset for text simulation too
                if (movementInterval) clearInterval(movementInterval);
                movementInterval = setInterval(() => {
                    simulateServicemanMovement(true); // Pass true to simulate text only
                }, 3000); // Update text every 3 seconds

                return;
            }

            // --- Actual Google Map Initialization ---
            const destination = servicemanRoute[servicemanRoute.length - 1]; // Last point in route is destination
            
            // Clear any existing map and markers/paths if re-initializing
            if (map) {
                servicemanMarker.setMap(null);
                servicemanMarker = null;
                servicemanPath.setMap(null);
                servicemanPath = null;
            }

            map = new google.maps.Map(mapDiv, {
                zoom: 12,
                center: servicemanRoute[0], // Start map centered at service man's initial location
                mapTypeControl: false,
                streetViewControl: false,
                fullscreenControl: false
            });

            // Destination marker (customer's address)
            new google.maps.Marker({
                position: destination,
                map: map,
                title: 'Your Address',
                icon: {
                    url: 'http://maps.google.com/mapfiles/ms/icons/homegarden.png', // Home icon
                    scaledSize: new google.maps.Size(35, 35)
                }
            });

            // Service man marker
            servicemanMarker = new google.maps.Marker({
                position: servicemanRoute[0],
                map: map,
                title: 'Service Man Location',
                icon: {
                    url: 'http://maps.google.com/mapfiles/ms/icons/truck.png', // Truck icon
                    scaledSize: new google.maps.Size(40, 40)
                },
                animation: google.maps.Animation.DROP
            });

            // Path for the service man
            servicemanPath = new google.maps.Polyline({
                path: [], // Initially empty
                geodesic: true,
                strokeColor: '#A259FF', // Purple
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            servicemanPath.setMap(map);

            // Start simulating movement
            if (movementInterval) {
                clearInterval(movementInterval); // Clear any existing interval
            }
            currentServicemanLocationIndex = 0;
            simulateServicemanMovement(false); // Call once immediately for map-based tracking
            movementInterval = setInterval(() => {
                simulateServicemanMovement(false); // Update map and text every 3 seconds
            }, 3000); 

            console.log("Google Map initialized with service man location simulation.");
        }

        function simulateServicemanMovement(textOnly = false) {
            const servicemanStatusSpan = document.getElementById('servicemanStatus');
            const servicemanETASpan = document.getElementById('servicemanETA');
            const servicemanAddressSpan = document.getElementById('servicemanAddress');

            if (currentServicemanLocationIndex >= servicemanRoute.length) {
                // Service man has arrived
                clearInterval(movementInterval);
                movementInterval = null;
                servicemanETASpan.innerText = "Arrived!";
                servicemanStatusSpan.innerHTML = "Step 4: Service man arrived! <i class='fas fa-check-circle text-green-500 ml-2'></i>";
                servicemanStatusSpan.className = 'font-medium text-green-600'; // Green text for arrived
                if (!textOnly && servicemanMarker) {
                    servicemanMarker.setAnimation(null); // Stop animation
                }
                return;
            }

            const currentPos = servicemanRoute[currentServicemanLocationIndex];
            
            if (!textOnly && servicemanMarker) { // Update map only if not textOnly and marker exists
                servicemanMarker.setPosition(currentPos);
                map.setCenter(currentPos); // Keep map centered on service man

                // Update path
                const path = servicemanPath.getPath();
                if (path.getLength() === 0 || path.getAt(path.getLength() - 1).lat() !== currentPos.lat || path.getAt(path.getLength() - 1).lng() !== currentPos.lng) {
                    path.push(currentPos);
                }
            }
            
            // Calculate remaining distance/time (very basic simulation)
            const remainingSteps = servicemanRoute.length - 1 - currentServicemanLocationIndex;
            let etaMinutes = 0;
            if (remainingSteps > 0) {
                 etaMinutes = remainingSteps * 2; // Each step takes approx 2 minutes
            }
            
            servicemanETASpan.innerText = `${etaMinutes} minutes`;
            servicemanAddressSpan.innerText = currentPos.address;

            // Update status based on progress
            if (currentServicemanLocationIndex === 0) {
                servicemanStatusSpan.innerHTML = "Step 1: Waiting for service man...";
                servicemanStatusSpan.className = 'font-medium text-yellow-600';
            } else if (remainingSteps <= 2 && remainingSteps > 0) { // Last 2 steps: Arriving soon
                servicemanStatusSpan.innerHTML = "Step 3: Service man arriving soon!";
                servicemanStatusSpan.className = 'font-medium text-orange-600';
            } else if (currentServicemanLocationIndex > 0 && currentServicemanLocationIndex < (servicemanRoute.length - 1)) { // In transit
                servicemanStatusSpan.innerHTML = "Step 2: Service man started - On the way!";
                servicemanStatusSpan.className = 'font-medium text-blue-600'; // Changed to blue for "on the way"
            } 

            currentServicemanLocationIndex++;
        }


        // Initial update when page loads
        document.addEventListener('DOMContentLoaded', () => {
            updateCartCount();
        });

        // Event listeners for "Book a Service" buttons to scroll to services
        document.getElementById('bookServiceAppHeroBtn').addEventListener('click', function() {
            scrollToService('services-listing');
        });
        document.getElementById('bookServiceFinalCtaBtn').addEventListener('click', function() {
            scrollToService('services-listing');
        });

    </script>

</body>
</html>